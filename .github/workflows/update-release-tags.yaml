name: Update Release Tags
on:
  release:
    types:
      - published

jobs:
  update-tags:
    name: Update major/minor tags
    permissions:
      contents: write
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v6

      - name: Parse version
        id: version
        run: |
          VERSION="${{ github.event.release.tag_name }}"
          VERSION="${VERSION#v}"
          MAJOR="${VERSION%%.*}"
          MINOR="${VERSION#*.}"
          MINOR="${MINOR%%.*}"
          echo "major=$MAJOR" >> "$GITHUB_OUTPUT"
          echo "minor=$MINOR" >> "$GITHUB_OUTPUT"

      - name: Update major/minor tags
        run: |
          git tag -f "v${{ steps.version.outputs.major }}"
          git tag -f "v${{ steps.version.outputs.major }}.${{ steps.version.outputs.minor }}"
          git push origin -f "v${{ steps.version.outputs.major }}"
          git push origin -f "v${{ steps.version.outputs.major }}.${{ steps.version.outputs.minor }}"
